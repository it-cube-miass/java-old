# 3.5 Вещественные типы

| Тип | Содержит | По умолчанию | Размер | Диапазон | Класс обертка |
| :--- | :--- | :--- | :--- | :--- | :--- |
| float | вещественное знаковое | 0.0 | 32 bits | от 1.4E−45 до 3.4028235E+38 | Float |
| double | вещественное знаковое | 0.0 | 64 bits | от 4.9E−324 до 1.7976931348623157E+308 | Double |

Вещественные числа в Java представлены типами данных _float_ и _double_. Как показано в таблицах выше, _float_ является 32 битным значением с плавающей точкой, с обычной точностью, а _double_ представляет 64 битное значение с плавающей точкой, с двойной точностью. Количество бит отведенные под представление этих чисел смотрите в таблице выше. Оба типа соответствуют стандарту IEEE 754-1985, который определяет формат чисел и арифметические операции, применимые к этим числам. Но есть и небольшие отличия от этого стандарта. К обычным вещественным числам добавляются еще четыре значения:

* положительная бесконечность, выражаемая константой _POSITIVE\_INFINITY_ и возникающая при переполнении положительного значения, например в результате операции умножения 3.0\*6e307 или при делении на нуль;
* отрицательная бесконечность _NEGATIVE\_INFINITY_, возникающая при переполнении отрицательного значения, например в результате операции умножения -3.0\*6e307 или при делении на нуль отрицательного числа;
* "не число", записываемое константой _NaN_ \(Not a Number\) и возникающее, например, при умножении нуля на бесконечность.
* положительный и отрицательный нуль, возникающий при делении на бесконечность соответствующего знака, хотя сравнение 0.0 == -0.0 дает в результате _true_.

Операции с бесконечностями выполняются по обычным математическим правилам. Во всем остальном вещественные типы — это обычные вещественные значения, к которым применимы все арифметические операции и операции сравнения.

## Вещественные литералы

Значения с плавающей точкой можно непосредственно включать в Java программу. В такой величине за необязательной последовательностью цифр следует десятичная точка и другая последовательность цифр.

```java
double d1 = 123.45;
double d2 = 0.0;
double d3 = .01;
double d4 = 5.;
```

Литералы с плавающей точкой можно также представить в экспоненциальной, или научной, нотации, в которой за числом следует буква e или E \(показатель степени\) и другое число. Второе число представляет степень десятки, на которую умножается первое число. Если же число записано в шестнадцатеричном формате, то экспонента это степень двойки.

```java
double d1 = 1.2345E02; // 123.45
double d2 = 1e-6; // 0.000001
```

Литералы с плавающей точкой по умолчанию являются значениями типа _double_. При включении значения типа _float_ в программу за числом следует поставить символ f или F:

```java
double d = 6.0;
float f = 6.0f;
```

В принципе литералы типа _double_ можно тоже обозначать суффиксом d или D, но это особо не имеет смысла, так как вещественные литералы всегда по умолчанию _double_.

Большинство вещественных чисел, по самой их природе, нельзя точно представить каким-либо конечным количеством битов. Таким образом, необходимо помнить, что значения _float_ и _double_ являются только приближенными значениями представляемых ими чисел. _float_ – это 32 битное приближение, которое дает как минимум 6 значимых десятичных разрядов, а _double_ – это 64 битное приближение, которое представляет по крайней мере 15 значимых десятичных разрядов. На практике эти числа подходят для большинства вычислений с вещественными числами.

Поскольку типы с плавающей точкой в Java могут сводить переполнение к бесконечности, антипереполнение – к нулю, а также имеют особое NaN значение, то арифметические операции с плавающей точкой никогда не генерируют исключений, даже при выполнении недопустимых операций, например при делении нуля на нуль либо при вычислении корня отрицательного числа.

Бесконечные значения с плавающей точкой ведут себя вполне логично. Например, прибавление к бесконечности или вычитание из нее любого конечного значения дает бесконечность. Поведение отрицательного нуля почти не отличается от положитель ного нуля; Единственный способ отличить отрицательный нуль от по ложительного или обычного нуля – разделить на него какое-либо число. `1.0 / 0.0` дает положительную бесконечность, а деление 1.0 на отрицательный нуль дает отрицательную бесконечность.

И наконец, поскольку `NaN` не является числом, оператор == сообщает, что это значение не равно ни одному другому числу, включая само значение! Чтобы проверить, являются ли значения _float_ и _double_ нечисловыми \(NaN\), следует вызвать методы `Float.isNaN()` и `Double.isNaN()`.

Вычисления чисел с плавающей точкой на одном и том же, а тем более на разных процессорах могут давать несколько разные результаты, поскольку виртуальная машина java выполняет эти операции на сопроцессоре \(FPU\), если он присутствует на устройстве. А в сопроцессоре обычно регистры для работы с плавающей точкой 80 бит, что шире даже чем double. Поэтому, если в эти регистры положить числа double, а потом опять вернуть их в double, то результаты могут быть разные для одинаковых чисел, по умолчанию java эту проблему не решает, то есть нет гарантии, что написанный код будет давать одинаковый результат на разных процессорах. Это сделано потому, что желательно использовать сопроцессор для скорости вычислений. Результаты в этом случае могут немного различаться.

Чтобы результаты были на всех процессорах одинаковые, то следует использовать ключевое слово strictfp в декларации метода, например:

```java
public static strictfp void main(String[] args)
```

В данном случае все что будет происходить в методе main, будет происходить без участия сопроцессора, будет строго округляться в пределах 64 бит и результат будет одинаковым на разных процессорах.

